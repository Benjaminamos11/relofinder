---
/**
 * Agency Profile Page Template - Enhanced Design
 * Premium brand design with gradient highlights, trust signals, and elegant UI
 * URL: /companies-new/[id]
 * 
 * Sections (in order):
 * 1. Hero Snapshot (gradient heading + trust signals)
 * 2. Quick Facts Row
 * 3. Review Summary (AI + External)
 * 4. Services & Coverage (split card design)
 * 5. Pros & Cons
 * 6. Who They're Best For
 * 7. User Reviews
 * 8. FAQ
 * 9. Alternatives (carousel-style)
 * 10. Disclaimer
 */

import Layout from '../../layouts/Layout.astro';
import SchemaMarkup from '../../components/common/SchemaMarkup.astro';
import { getCollection } from 'astro:content';
import { supabase } from '../../lib/supabase';

// Generate static paths
export async function getStaticPaths() {
  const companies = await getCollection('companies');
  return companies.map((company: any) => ({
    params: { id: company.data.id },
    props: { company },
  }));
}

const { company } = Astro.props;
const companyData = company.data;

// Fetch Supabase data (reviews, tier, summary)
let reviews = [];
let reviewSummary = null;
let weightedRating = companyData.rating?.score || 4.5;
let tier = companyData.tier || 'standard';

try {
  // Fetch reviews
  const { data: reviewsData } = await supabase
    .from('reviews')
    .select(`
      *,
      review_replies (
        id,
        author_name,
        body,
        created_at
      )
    `)
    .eq('relocator_id', companyData.id)
    .eq('status', 'approved')
    .order('created_at', { ascending: false });
  
  reviews = (reviewsData || []).map((r: any) => ({
    ...r,
    reply: r.review_replies?.[0] || null,
  }));

  // Fetch AI summary
  const { data: summaryData } = await supabase
    .from('review_summaries')
    .select('*')
    .eq('relocator_id', companyData.id)
    .single();
  
  reviewSummary = summaryData;

  // Calculate weighted rating if we have data
  if (reviewSummary?.weighted_rating) {
    weightedRating = reviewSummary.weighted_rating;
  }
} catch (error) {
  console.error('Error fetching Supabase data:', error);
}

// Get alternatives (same region/service)
const allCompanies = await getCollection('companies');
const alternatives = allCompanies
  .filter((c: any) => c.data.id !== companyData.id)
  .slice(0, 3);

// SEO
const title = `${companyData.name} ‚Äî Relocation Profile & Reviews (Switzerland) | ReloFinder`;
const description = `Independent profile of ${companyData.name}: services, regions (${companyData.regions?.slice(0,3).join(', ')}), verified reviews, and alternatives. ${companyData.description}`;

// FAQ data
const faqs = companyData.faqs || [
  {
    question: `What regions does ${companyData.name} cover?`,
    answer: `${companyData.name} provides services in ${companyData.regions?.join(', ') || 'multiple Swiss regions'}. They offer comprehensive relocation support across these areas.`
  },
  {
    question: `What services does ${companyData.name} offer?`,
    answer: `${companyData.name} specializes in ${companyData.services?.slice(0,3).join(', ') || 'comprehensive relocation services'}. They provide end-to-end solutions for your relocation needs.`
  },
  {
    question: `Is ${companyData.name} suitable for corporate relocations?`,
    answer: `Yes, ${companyData.name} has experience with both corporate and private relocations. They can tailor packages to meet specific business or individual needs.`
  },
  {
    question: `What languages does the team speak?`,
    answer: `The ${companyData.name} team provides services in ${companyData.languages?.join(', ') || 'multiple languages'}, ensuring smooth communication throughout your relocation.`
  },
  {
    question: `How quickly can they respond to inquiries?`,
    answer: tier === 'preferred' 
      ? `As a Preferred Partner, ${companyData.name} typically responds within 24 hours. You can also schedule a meeting directly through their profile.`
      : `${companyData.name} aims to respond to all inquiries promptly. Contact them directly for the fastest response.`
  },
  {
    question: `How do I compare ${companyData.name} with others?`,
    answer: `You can use our comparison tool to evaluate multiple agencies based on ratings, services, regional coverage, and client reviews.`
  },
];

// Import components
import AgencyTierBadge from '../../components/agencies/AgencyTierBadge';
import AgencyReviewSummary from '../../components/agencies/AgencyReviewSummary';
import ReviewForm from '../../components/agencies/ReviewForm';
import ReviewsList from '../../components/agencies/ReviewsList';
---

<Layout title={title} description={description}>
  <!-- Schema Markup -->
  <SchemaMarkup 
    type="company"
    data={{
      name: companyData.name,
      description: companyData.description,
      rating: weightedRating,
      reviewCount: companyData.rating?.reviews || 0,
    }}
  />

  <!-- 1. HERO SECTION - Enhanced with gradient heading and trust signals -->
  <section class="relative py-12 lg:py-20 overflow-hidden">
    <!-- Radial gradient background -->
    <div class="absolute inset-0 bg-gradient-radial from-white via-primary-50/30 to-white"></div>
    
    <div class="container mx-auto px-4 relative z-10">
      <div class="max-w-5xl mx-auto">
        <!-- Breadcrumbs -->
        <nav class="flex items-center gap-2 text-sm text-gray-600 mb-6">
          <a href="/" class="hover:text-primary-600 transition-colors">Home</a>
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"/></svg>
          <a href="/companies" class="hover:text-primary-600 transition-colors">Companies</a>
          <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20"><path d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z"/></svg>
          <span class="text-gray-900 font-medium">{companyData.name}</span>
        </nav>

        <!-- Main heading with gradient highlight -->
        <h1 class="text-4xl lg:text-5xl font-bold text-gray-900 mb-4 leading-tight group">
          {companyData.name} ‚Äî <span class="bg-gradient-to-r from-primary-600 via-purple-600 to-blue-600 bg-clip-text text-transparent animate-gradient-x">Relocation Experts</span> Switzerland
        </h1>

        <!-- Tagline -->
        <p class="text-xl text-gray-700 mb-8 leading-relaxed">
          {companyData.description}
        </p>

        <!-- Transparent badges with subtle blur -->
        <div class="flex flex-wrap gap-3 mb-8">
          {companyData.founded && (
            <div class="backdrop-blur-sm bg-white/60 border border-gray-200/50 px-4 py-2 rounded-full shadow-sm hover:shadow-md transition-shadow">
              <span class="text-sm font-medium text-gray-700">üïí Founded {companyData.founded}</span>
            </div>
          )}
          
          {companyData.languages && companyData.languages.length > 0 && (
            <div class="backdrop-blur-sm bg-white/60 border border-gray-200/50 px-4 py-2 rounded-full shadow-sm hover:shadow-md transition-shadow">
              <span class="text-sm font-medium text-gray-700">üåç {companyData.languages.slice(0, 4).join(' / ')}</span>
            </div>
          )}

          {companyData.verified && (
            <div class="backdrop-blur-sm bg-gradient-to-r from-amber-50 to-yellow-50 border border-amber-200/50 px-4 py-2 rounded-full shadow-sm hover:shadow-md transition-shadow">
              <span class="text-sm font-semibold text-amber-700">‚úì Verified Partner</span>
            </div>
          )}

          <AgencyTierBadge tier={tier} client:load />
        </div>

        <!-- Trust signals row -->
        <div class="flex flex-wrap items-center gap-6 text-sm text-gray-600 pb-8 border-b border-gray-200">
          <div class="flex items-center gap-2">
            <span class="text-primary-600">‚≠ê</span>
            <span class="font-medium">Google Verified</span>
          </div>
          <div class="flex items-center gap-2">
            <span class="text-primary-600">üá®üá≠</span>
            <span class="font-medium">Swiss Quality</span>
          </div>
          {companyData.founded && (
            <div class="flex items-center gap-2">
              <span class="text-primary-600">üïí</span>
              <span class="font-medium">Est. {companyData.founded}</span>
            </div>
          )}
        </div>
      </div>
    </div>
  </section>

  <!-- 2. QUICK FACTS ROW -->
  <section class="py-8 bg-gradient-to-br from-gray-50 to-primary-50/30">
    <div class="container mx-auto px-4">
      <div class="max-w-5xl mx-auto grid grid-cols-2 md:grid-cols-4 gap-6">
        <!-- Rating -->
        <div class="text-center">
          <div class="flex items-center justify-center gap-1 mb-2">
            <svg class="w-6 h-6 text-yellow-400" fill="currentColor" viewBox="0 0 20 20">
              <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
            </svg>
            <span class="text-3xl font-bold text-gray-900">{weightedRating.toFixed(1)}</span>
          </div>
          <p class="text-sm text-gray-600">{companyData.rating?.reviews || 0} reviews</p>
        </div>

        <!-- Founded -->
        {companyData.founded && (
          <div class="text-center">
            <p class="text-3xl font-bold text-gray-900 mb-1">{new Date().getFullYear() - companyData.founded}+</p>
            <p class="text-sm text-gray-600">Years Experience</p>
          </div>
        )}

        <!-- Team Size -->
        {companyData.employees && (
          <div class="text-center">
            <p class="text-3xl font-bold text-gray-900 mb-1">{companyData.employees}</p>
            <p class="text-sm text-gray-600">Team Members</p>
          </div>
        )}

        <!-- Services -->
        <div class="text-center">
          <p class="text-3xl font-bold text-gray-900 mb-1">{companyData.services?.length || 0}</p>
          <p class="text-sm text-gray-600">Services</p>
        </div>
      </div>
    </div>
  </section>

  <!-- 3. REVIEW SUMMARY (AI + External) -->
  <section class="py-16 bg-white">
    <div class="container mx-auto px-4">
      <div class="max-w-4xl mx-auto">
        <AgencyReviewSummary
          relocatorId={companyData.id}
          relocatorName={companyData.name}
          existingSummary={reviewSummary}
          client:load
        />

        {/* AI Summary highlights */}
        {reviewSummary && (
          <div class="mt-8 bg-gradient-to-br from-gray-50 to-primary-50 rounded-2xl p-8 border border-gray-200">
            <div class="flex items-center gap-3 mb-4">
              <div class="flex">
                {Array.from({ length: 5 }).map((_, i) => (
                  <svg
                    key={i}
                    class={`w-6 h-6 ${i < Math.floor(weightedRating) ? 'text-yellow-400' : 'text-gray-300'}`}
                    fill="currentColor"
                    viewBox="0 0 20 20"
                  >
                    <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                  </svg>
                ))}
              </div>
              <span class="text-2xl font-bold text-gray-900">{weightedRating.toFixed(1)}</span>
            </div>
            
            <p class="text-gray-700 text-lg leading-relaxed mb-6">
              {reviewSummary.summary || `Clients praise ${companyData.name}'s professionalism and responsiveness.`}
            </p>

            <a 
              href="#reviews" 
              class="inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-primary-600 to-primary-700 text-white font-semibold rounded-xl shadow-md hover:shadow-lg hover:from-primary-700 hover:to-primary-800 transition-all"
            >
              Read Verified Reviews
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
              </svg>
            </a>
          </div>
        )}
      </div>
    </div>
  </section>

  <!-- 4. SERVICES & COVERAGE - Split card with center gradient divider -->
  <section class="py-16 bg-gradient-radial from-white via-primary-50/20 to-white">
    <div class="container mx-auto px-4">
      <div class="max-w-4xl mx-auto">
        <h2 class="text-3xl font-bold text-gray-900 mb-3 text-center">
          Services & <span class="bg-gradient-to-r from-primary-600 to-secondary-600 bg-clip-text text-transparent">Coverage</span>
        </h2>
        <p class="text-gray-700 mb-8 leading-relaxed text-center max-w-2xl mx-auto">
          {companyData.name} delivers end-to-end solutions across Switzerland, supporting private, corporate, and executive relocations.
        </p>

        <div class="relative bg-white rounded-2xl overflow-hidden shadow-md border border-gray-200">
          <!-- Center gradient divider -->
          <div class="absolute top-0 left-1/2 -translate-x-1/2 w-px h-full bg-gradient-to-b from-primary-200 via-primary-400 to-primary-200 hidden md:block"></div>
          
          <div class="grid md:grid-cols-2 gap-0">
            {/* Services */}
            {companyData.services && companyData.services.length > 0 && (
              <div class="p-8 border-r border-gray-100">
                <div class="flex items-center gap-3 mb-6">
                  <div class="w-10 h-10 bg-gradient-to-r from-primary-500 to-primary-600 rounded-lg flex items-center justify-center shadow-sm">
                    <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
                    </svg>
                  </div>
                  <h3 class="text-xl font-bold text-gray-900">Services Offered</h3>
                </div>
                <ul class="space-y-3">
                  {companyData.services.slice(0, 8).map((service: string) => (
                    <li class="flex items-start gap-3 text-gray-700">
                      <span class="flex-shrink-0 w-5 h-5 bg-gradient-to-r from-pink-100 to-primary-100 rounded-full flex items-center justify-center mt-0.5">
                        <svg class="w-3 h-3 text-primary-600" fill="currentColor" viewBox="0 0 20 20">
                          <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" />
                        </svg>
                      </span>
                      <span class="capitalize">{service.replace(/-/g, ' ')}</span>
                    </li>
                  ))}
                </ul>
              </div>
            )}

            {/* Regions */}
            {companyData.regions && companyData.regions.length > 0 && (
              <div class="p-8">
                <div class="flex items-center gap-3 mb-6">
                  <div class="w-10 h-10 bg-gradient-to-r from-primary-500 to-primary-600 rounded-lg flex items-center justify-center shadow-sm">
                    <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                    </svg>
                  </div>
                  <h3 class="text-xl font-bold text-gray-900">Regional Coverage</h3>
                </div>
                <ul class="space-y-3">
                  {companyData.regions.slice(0, 8).map((region: string) => (
                    <li class="flex items-start gap-3 text-gray-700">
                      <span class="flex-shrink-0 text-primary-600 mt-0.5">üìç</span>
                      <span class="capitalize">{region.replace(/-/g, ' ')}</span>
                    </li>
                  ))}
                </ul>
              </div>
            )}
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- 5. PROS & CONS -->
  {(companyData.pros || companyData.cons) && (
    <section class="py-16 bg-white">
      <div class="container mx-auto px-4">
        <div class="max-w-4xl mx-auto">
          <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center">
            Pros & Cons
          </h2>
          <div class="grid md:grid-cols-2 gap-8 bg-gradient-to-br from-gray-50 to-primary-50 rounded-2xl p-8 border border-gray-200 shadow-sm">
            {/* Pros */}
            {companyData.pros && (
              <div>
                <div class="flex items-center gap-2 mb-4">
                  <div class="w-8 h-8 bg-green-500 rounded-lg flex items-center justify-center shadow-sm">
                    <span class="text-white font-bold">‚úì</span>
                  </div>
                  <h3 class="font-bold text-green-900 text-lg">Strengths</h3>
                </div>
                <ul class="space-y-3">
                  {companyData.pros.map((pro: string) => (
                    <li class="flex items-start gap-3 text-gray-700">
                      <span class="text-green-600 flex-shrink-0 mt-1">‚Ä¢</span>
                      <span>{pro}</span>
                    </li>
                  ))}
                </ul>
              </div>
            )}

            {/* Cons */}
            {companyData.cons && (
              <div>
                <div class="flex items-center gap-2 mb-4">
                  <div class="w-8 h-8 bg-orange-500 rounded-lg flex items-center justify-center shadow-sm">
                    <span class="text-white font-bold">!</span>
                  </div>
                  <h3 class="font-bold text-orange-900 text-lg">Considerations</h3>
                </div>
                <ul class="space-y-3">
                  {companyData.cons.map((con: string) => (
                    <li class="flex items-start gap-3 text-gray-700">
                      <span class="text-orange-600 flex-shrink-0 mt-1">‚Ä¢</span>
                      <span>{con}</span>
                    </li>
                  ))}
                </ul>
              </div>
            )}
          </div>
        </div>
      </div>
    </section>
  )}

  <!-- 6. WHO THEY'RE BEST FOR -->
  {companyData.bestFor && companyData.bestFor.length > 0 && (
    <section class="py-16 bg-gradient-radial from-white via-primary-50/20 to-white">
      <div class="container mx-auto px-4">
        <div class="max-w-4xl mx-auto">
          <h2 class="text-3xl font-bold text-gray-900 mb-3 text-center">
            Who <span class="bg-gradient-to-r from-primary-600 to-secondary-600 bg-clip-text text-transparent">{companyData.name}</span> Is Best For
          </h2>
          <p class="text-gray-700 mb-6 text-center">
            Based on their expertise and service portfolio, {companyData.name} is particularly well-suited for:
          </p>
          <div class="bg-white rounded-2xl p-8 border border-gray-200 shadow-sm">
            <ul class="space-y-4">
              {companyData.bestFor.map((item: string) => (
                <li class="flex items-start gap-4">
                  <span class="flex-shrink-0 w-8 h-8 bg-gradient-to-r from-primary-600 to-primary-700 text-white rounded-lg flex items-center justify-center font-bold shadow-sm">‚Üí</span>
                  <span class="text-gray-800 text-lg pt-1">{item}</span>
                </li>
              ))}
            </ul>
          </div>
        </div>
      </div>
    </section>
  )}

  <!-- 7. USER REVIEWS SECTION -->
  <section id="reviews" class="py-16 bg-white">
    <div class="container mx-auto px-4">
      <div class="max-w-4xl mx-auto">
        <h2 class="text-3xl font-bold text-gray-900 mb-3 text-center">
          User <span class="bg-gradient-to-r from-primary-600 to-secondary-600 bg-clip-text text-transparent">Reviews</span>
        </h2>
        <p class="text-gray-600 mb-8 text-center">
          Real experiences from people who have used {companyData.name}
        </p>

        {/* Review Form */}
        <div class="mb-12">
          <ReviewForm 
            relocatorId={companyData.id}
            relocatorName={companyData.name}
            client:load
          />
        </div>

        {/* Reviews List */}
        <ReviewsList 
          reviews={reviews}
          canReply={tier === 'partner' || tier === 'preferred'}
          client:load
        />
      </div>
    </div>
  </section>

  <!-- 8. FAQ SECTION -->
  <section class="py-16 bg-gradient-radial from-white via-primary-50/20 to-white">
    <div class="container mx-auto px-4">
      <div class="max-w-4xl mx-auto">
        <h2 class="text-3xl font-bold text-gray-900 mb-3 text-center">
          Frequently Asked <span class="bg-gradient-to-r from-primary-600 to-secondary-600 bg-clip-text text-transparent">Questions</span>
        </h2>
        <p class="text-gray-600 mb-8 text-center">
          Common questions about {companyData.name}
        </p>

        <div class="space-y-4">
          {faqs.slice(0, 3).map((faq: any, index: number) => (
            <details class="bg-white/80 backdrop-blur-sm rounded-xl border border-gray-200 overflow-hidden group shadow-sm hover:shadow-md transition-all">
              <summary class="px-6 py-5 font-semibold text-gray-900 cursor-pointer hover:bg-primary-50/50 transition-colors flex items-center justify-between">
                <span class="pr-8">{faq.question}</span>
                <svg
                  class="w-5 h-5 text-primary-600 group-open:rotate-180 transition-transform flex-shrink-0"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                </svg>
              </summary>
              <div class="px-6 pb-5 text-gray-700 leading-relaxed border-t border-gray-200 bg-white">
                <div class="pt-4">{faq.answer}</div>
              </div>
            </details>
          ))}
        </div>
      </div>
    </div>
  </section>

  <!-- 9. ALTERNATIVES - Carousel-style cards -->
  {alternatives.length > 0 && (
    <section class="py-16 bg-white">
      <div class="container mx-auto px-4">
        <div class="max-w-6xl mx-auto">
          <h2 class="text-3xl font-bold text-gray-900 mb-3 text-center">
            Other Agencies to <span class="bg-gradient-to-r from-primary-600 to-secondary-600 bg-clip-text text-transparent">Compare</span>
          </h2>
          <p class="text-gray-600 mb-8 text-center">
            Explore alternative relocation agencies operating in Switzerland
          </p>

          <div class="grid md:grid-cols-3 gap-6">
            {alternatives.map((alt: any) => (
              <a
                href={`/companies/${alt.data.id}`}
                class="group bg-white rounded-2xl p-6 border border-gray-200 hover:border-primary-300 hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1"
              >
                <div class="mb-4">
                  <h3 class="font-bold text-gray-900 group-hover:text-primary-600 transition-colors text-lg mb-2">
                    {alt.data.name}
                  </h3>
                  <span class="inline-block px-3 py-1 bg-gray-100 text-gray-600 text-xs rounded-full font-medium">
                    Verified Agency
                  </span>
                </div>

                {alt.data.rating?.score && (
                  <div class="flex items-center gap-2 mb-4">
                    <div class="flex">
                      {Array.from({ length: 5 }).map((_, i) => (
                        <svg
                          key={i}
                          class={`w-4 h-4 ${i < Math.floor(alt.data.rating.score) ? 'text-yellow-400' : 'text-gray-300'}`}
                          fill="currentColor"
                          viewBox="0 0 20 20"
                        >
                          <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z" />
                        </svg>
                      ))}
                    </div>
                    <span class="text-sm font-semibold text-gray-700">
                      {alt.data.rating.score.toFixed(1)}
                    </span>
                  </div>
                )}

                {alt.data.specializations && alt.data.specializations.length > 0 && (
                  <div class="flex flex-wrap gap-2">
                    {alt.data.specializations.slice(0, 2).map((spec: string) => (
                      <span class="text-xs bg-primary-50 text-primary-700 px-2 py-1 rounded-full font-medium">
                        {spec}
                      </span>
                    ))}
                  </div>
                )}
              </a>
            ))}
          </div>

          {/* Sticky CTA */}
          <div class="mt-12 text-center">
            <a 
              href="/companies" 
              class="inline-flex items-center gap-2 px-8 py-4 bg-gradient-to-r from-primary-600 to-primary-700 text-white font-bold rounded-xl shadow-lg hover:shadow-xl hover:from-primary-700 hover:to-primary-800 transition-all transform hover:scale-105"
            >
              Compare All Agencies
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6" />
              </svg>
            </a>
          </div>
        </div>
      </div>
    </section>
  )}

  <!-- 10. DISCLAIMER -->
  <section class="py-12 bg-gray-50">
    <div class="container mx-auto px-4">
      <div class="max-w-4xl mx-auto">
        <div class="bg-white rounded-xl p-6 border border-gray-200 shadow-sm">
          <p class="text-sm text-gray-600 leading-relaxed">
            <strong class="text-gray-900">Disclaimer:</strong> ReloFinder is an independent comparison platform. We do not provide relocation services directly. This profile is based on publicly available information, verified sources, and user reviews. While we strive for accuracy, we recommend contacting {companyData.name} directly to confirm current services, pricing, and availability.
          </p>
        </div>
      </div>
    </div>
  </section>

  <style>
    @keyframes gradient-x {
      0%, 100% {
        background-position: 0% 50%;
      }
      50% {
        background-position: 100% 50%;
      }
    }

    .animate-gradient-x {
      background-size: 200% 200%;
      animation: gradient-x 3s ease infinite;
    }

    .bg-gradient-radial {
      background-image: radial-gradient(circle at center, var(--tw-gradient-stops));
    }
  </style>
</Layout>
