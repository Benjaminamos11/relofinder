---
import { 
  MapPin, 
  Building2, 
  Star, 
  ArrowRight, 
  Home, 
  ChevronDown,
  FileText,
  Download,
  Feather,
  CheckCircle2,
  Info
} from 'lucide-react';
import '../../styles/global.css';
import '../../styles/alpine-clarity.css';
import SEOHead from '../../components/common/SEOHead.astro';
import UniversalContactModal from '../../components/common/UniversalContactModal.tsx';
import '../../lib/expose-modal-stores.client.ts';
import Navbar from '../../components/layout/Navbar.astro';
import Footer from '../../components/layout/Footer.astro';
import HeroSearch from '../../components/home/HeroSearch.tsx';

// --- Data & Content ---

const neighborhoods = [
  {
    name: "Ouchy & Sous-Gare",
    type: "The Lakefront",
    desc: "Prestigious, flat, and walkable. Home to grand hotels, the Olympic Museum, and the beautiful lakeside promenade. Premium addresses.",
    rent: "CHF 3,500 - 5,500+",
    vibe: "Prestigious & Scenic"
  },
  {
    name: "Pully & Lutry",
    type: "East Suburbs",
    desc: "Famous for the UNESCO Lavaux vineyards, lower taxes, and larger family villas with stunning lake views. The classic expat choice.",
    rent: "CHF 3,200 - 6,000+",
    vibe: "Vineyard & Family"
  },
  {
    name: "Chailly",
    type: "Village in the City",
    desc: "High up on the hill, residential, and favored by families for its community feel, excellent schools, and forest access.",
    rent: "CHF 2,800 - 4,200",
    vibe: "Family & Community"
  },
  {
    name: "Le Flon & Centre",
    type: "Urban Pulse",
    desc: "Trendy lofts, nightlife, restaurants, and modern renovations in former industrial spaces. The choice for young professionals.",
    rent: "CHF 2,500 - 4,000",
    vibe: "Trendy & Central"
  }
];

const costOfLiving = [
  { category: "Rent (3.5 rooms)", cost: "CHF 2,800 - 4,800", note: "10-15% cheaper than Geneva" },
  { category: "Health Insurance", cost: "CHF 400 - 550", note: "Per adult / month" },
  { category: "Public Transport", cost: "CHF 75", note: "TL Monthly Pass (Mobilis)" },
  { category: "Kindergarten", cost: "~CHF 2,400", note: "Private / Bilingual (Month)" },
];

const faqs = [
  {
    q: "Is Lausanne cheaper than Geneva?",
    a: "Yes, rents are typically 10-20% lower than Geneva for comparable properties. However, tax rates in Canton Vaud can be comparable to Geneva, so the overall cost difference depends on your income bracket. For families, Lausanne often offers better value."
  },
  {
    q: "Do I need a car in Lausanne?",
    a: "Not if you live near the M1 or M2 Metro lines. The city is built on three steep hills, so cycling requires an E-Bike unless you're very fit. The metro and bus network is excellent, and the Lausanne-Flon hub connects everything."
  },
  {
    q: "Where are the international schools?",
    a: "Major schools include the International School of Lausanne (ISL) in Le Mont-sur-Lausanne, Coll√®ge Champittet in Pully, and √âcole Nouvelle in Chailly. Many expat families choose Pully or Lutry specifically for school proximity."
  }
];

---

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <SEOHead 
      title="Relocation to Lausanne: The Complete 2026 Guide | ReloFinder"
      description="The definitive guide for moving to Lausanne. Housing, neighborhoods, EPFL/IMD area, and relocation checklists. Compare verified agencies and get free quotes."
    />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Playfair+Display:ital,wght@0,400;0,600;1,400&display=swap" rel="stylesheet">
    <style>
        /* Swiss Passport Style Canton Cards Pattern */
        .canton-card-bg {
            font-family: 'Inter', sans-serif;
            font-weight: 800;
            color: #F1F5F9; 
            opacity: 0.4;
            line-height: 1;
        }
        
        /* Custom Gradient Text */
        .text-gradient {
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-image: linear-gradient(90deg, #2C3E50 0%, #FF6F61 100%);
        }
    </style>
</head>
<body class="font-sans text-slate-600 bg-[#F9FAFB] antialiased">

    <!-- 1. Navbar -->
    <Navbar />


    <!-- Hero Section -->
    <section class="relative py-20 lg:py-32 overflow-hidden">
        <div class="absolute inset-0 z-0">
            <img 
                src="https://res.cloudinary.com/dphbnwjtx/image/upload/f_webp,q_auto:best/v1766821274/patrick-william-NvGAO6E65K0-unsplash_rnmvd5" 
                alt="Lausanne cityscape with lake Geneva and Alps" 
                class="w-full h-full object-cover"
            />
            <!-- Gradient overlay: slightly darker for this image -->
            <div class="absolute inset-0 bg-gradient-to-b from-black/55 via-black/45 to-black/65"></div>
        </div>

        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center relative z-10">
            <div class="max-w-4xl mx-auto mb-12">
                <span class="inline-block py-1.5 px-4 rounded-full bg-black/80 border border-black/20 text-white text-sm font-bold mb-6 tracking-wide uppercase">
                    2026 City Guide
                </span>
                <h1 class="text-5xl md:text-6xl lg:text-7xl font-bold tracking-tight text-white mb-6 leading-[1.1] drop-shadow-lg">
                    Relocation to <span class="text-[#FF6F61]">Lausanne</span>.
                </h1>
                <p class="text-lg md:text-xl text-white/90 font-medium max-w-2xl mx-auto drop-shadow-md">
                    The Olympic Capital and academic heart of Switzerland. 
                    A guide for families, researchers, and executives moving to Canton Vaud.
                </p>
            </div>

            <!-- Lead Magnet: Hero Search (Lead Wizard) -->
            <div class="max-w-3xl mx-auto relative z-10 text-left">
               <div class="bg-white rounded-2xl shadow-xl shadow-slate-900/5 border border-slate-200 p-1">
                   <HeroSearch client:load prefilledDestination="lausanne" />
               </div>
               <p class="text-center text-sm text-white/80 mt-6 font-medium drop-shadow">
                   Compare verified Lausanne relocation agencies. Get 3 quotes in 24h.
               </p>
            </div>
        </div>
    </section>

    <!-- 3. Strategic Overview: Why You Need Help -->
    <section class="py-24 bg-white border-y border-slate-100">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl md:text-4xl font-bold text-slate-800 mb-8 text-center">
                Why relocating to Lausanne is a question of altitude.
            </h2>
            <div class="prose prose-lg prose-slate mx-auto text-slate-600 leading-relaxed">
                <p class="text-lg mb-6 text-center max-w-3xl mx-auto">
                    Lausanne is built on three hills. Your quality of life is defined by your proximity to the <span class="font-bold text-slate-900">M2 Metro</span>. 
                    Living "down" (Ouchy) means lake views; living "up" (Epalinges) means access to forests and golf.
                </p>
                
                <div class="bg-[#F9FAFB] p-8 rounded-2xl border border-slate-200 my-10">
                    <p class="text-lg leading-relaxed mb-6">
                        The rental market is competitive, driven by the massive influx of talent to <strong>EPFL</strong>, <strong>IMD</strong>, and the <strong>IOC</strong>. 
                        Like Geneva, the market is managed by <strong>R√©gies</strong>, requiring a precise administrative approach.
                        Access to <a href="https://offlist.ch" class="text-[#FF6F61] font-medium hover:underline">off-market inventory</a> in Pully and Lutry is essential.
                    </p>
                    <p class="text-lg leading-relaxed font-medium text-slate-800">
                        <strong>Relofinder</strong> connects you with local experts who understand the Vaud tax system and have access to the hidden inventory.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- 4. Neighborhood Decoder -->
    <section class="py-24 bg-[#F9FAFB] border-b border-slate-200">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-3xl md:text-4xl font-bold text-slate-800 mb-4">Where Expats Live in Lausanne</h2>
                <p class="text-slate-500 text-lg">From the lakefront to the vineyards: Finding your altitude.</p>
            </div>

            <div class="grid md:grid-cols-2 lg:grid-cols-4 gap-8">
                {neighborhoods.map(hood => (
                    <div class="bg-white rounded-2xl border border-slate-200 p-8 shadow-sm hover:shadow-xl hover:-translate-y-1 transition-all duration-300 flex flex-col h-full">
                        <div class="mb-6">
                            <span class="inline-block px-3 py-1 bg-slate-100 text-slate-600 text-xs font-bold rounded-full uppercase tracking-wider">
                                {hood.type}
                            </span>
                        </div>
                        <h3 class="text-2xl font-bold text-slate-800 mb-3">{hood.name}</h3>
                        <p class="text-slate-600 mb-8 leading-relaxed flex-grow">
                            {hood.desc}
                        </p>
                        <div class="border-t border-slate-100 pt-6 mt-auto">
                            <div class="flex justify-between items-center mb-3">
                                <span class="text-xs text-slate-400 font-bold uppercase tracking-wider">Est. Rent</span>
                                <span class="text-sm font-bold text-slate-800">{hood.rent}</span>
                            </div>
                            <div class="flex justify-between items-center">
                                <span class="text-xs text-slate-400 font-bold uppercase tracking-wider">Vibe</span>
                                <span class="text-sm font-bold text-[#FF6F61]">{hood.vibe}</span>
                            </div>
                        </div>
                    </div>
                ))}
            </div>
            
            <div class="mt-16 p-6 bg-white border border-slate-200 rounded-xl flex flex-col md:flex-row gap-6 items-center max-w-3xl mx-auto shadow-sm">
                <div class="p-3 bg-[#FF6F61]/10 rounded-full flex-shrink-0">
                    <Info className="w-6 h-6 text-[#FF6F61]" />
                </div>
                <div class="text-center md:text-left">
                    <p class="text-slate-800 text-sm leading-relaxed">
                        <strong class="block text-base mb-1">Academic Calendar Alert</strong> 
                        The market peaks in September and February (academic semesters). 
                        Use <a href="https://offlist.ch" target="_blank" class="font-bold underline decoration-[#FF6F61] decoration-2 underline-offset-2 hover:text-[#FF6F61] transition-colors">Offlist.ch</a> 
                        to access pre-market listings from departing academics and researchers.
                    </p>
                </div>
            </div>
        </div>
    </section>

    <!-- 5. Cost of Living -->
    <section class="py-24 bg-white">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-3xl md:text-4xl font-bold text-slate-800 mb-4">Cost of Living 2026</h2>
                <div class="w-24 h-1 bg-[#FF6F61] mx-auto rounded-full mb-8"></div>
                <p class="text-slate-500 text-lg max-w-2xl mx-auto mb-4">
                    A family of four requires approximately <span class="font-bold text-slate-900 bg-slate-100 px-2 py-0.5 rounded">CHF 11,000</span> net monthly for a comfortable standard of living in Lausanne.
                </p>
                <p class="text-slate-500 text-base max-w-2xl mx-auto">
                    Generally <strong>10-15% more affordable</strong> than Geneva, with excellent schools and quality of life.
                </p>
            </div>

            <div class="bg-white rounded-2xl border border-slate-200 overflow-hidden shadow-sm">
                <table class="w-full text-left">
                    <thead class="bg-slate-50 border-b border-slate-200">
                        <tr>
                            <th class="p-6 text-xs font-bold text-slate-400 uppercase tracking-widest">Item</th>
                            <th class="p-6 text-xs font-bold text-slate-400 uppercase tracking-widest">Cost Estimate</th>
                            <th class="p-6 text-xs font-bold text-slate-400 uppercase tracking-widest hidden sm:table-cell">Notes</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-slate-100">
                        {costOfLiving.map(item => (
                            <tr class="hover:bg-slate-50/50 transition-colors group">
                                <td class="p-6 font-bold text-slate-800 group-hover:text-[#FF6F61] transition-colors">{item.category}</td>
                                <td class="p-6 font-bold text-slate-700">{item.cost}</td>
                                <td class="p-6 text-slate-500 text-sm hidden sm:table-cell">{item.note}</td>
                            </tr>
                        ))}
                    </tbody>
                </table>
            </div>




            <!-- Interstitial CTA: Polished Dark Version -->
            <div class="mt-20 bg-[#1E293B] rounded-3xl p-12 md:p-16 text-center text-white relative overflow-hidden ring-1 ring-white/10 shadow-2xl">
                <div class="relative z-10 max-w-2xl mx-auto">
                    <h3 class="text-3xl md:text-4xl font-bold mb-6 tracking-tight text-white">Get Accurate Relocation Rates.</h3>
                    <p class="text-slate-300 text-lg mb-10 leading-relaxed">
                        Don't guess with your budget. Request verified quotes from our network of Lausanne relocation agencies.
                    </p>
                    <button onclick="window.universalOpenModal({ page: 'lausanne_guide', topic: 'cost_cta' })" class="inline-flex items-center gap-3 px-8 py-4 bg-[#FF6F61] hover:bg-[#f65d4e] text-white font-bold text-lg rounded-xl transition-all transform hover:-translate-y-1 shadow-lg">
                        <FileText className="w-5 h-5" />
                        Get Free Quotes
                    </button>
                    <p class="mt-6 text-slate-400 text-sm">Free service. No obligation.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- 6. Relocation Timeline: Simple Card Layout -->
    <section class="py-24 bg-[#F9FAFB] border-t border-slate-200">
        <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-3xl md:text-4xl font-bold text-slate-800 mb-16 text-center">Your Relocation Timeline</h2>
            
            <div class="space-y-8">
                <!-- Step 1 -->
                <div class="bg-white rounded-2xl p-8 border border-slate-200 shadow-sm hover:shadow-md transition-shadow">
                    <div class="flex items-start gap-6">
                        <div class="shrink-0 w-14 h-14 bg-[#FF6F61] rounded-xl flex items-center justify-center text-white font-bold text-lg shadow-lg">
                            01
                        </div>
                        <div class="flex-1">
                            <div class="flex items-center gap-3 mb-3">
                                <span class="px-3 py-1 bg-slate-100 text-slate-500 text-xs font-bold rounded-full uppercase tracking-wider border border-slate-200">3 Months Out</span>
                            </div>
                            <h3 class="text-xl font-bold text-slate-800 mb-2">The Search</h3>
                            <p class="text-slate-600 leading-relaxed">
                                The market peaks in <strong>September/February</strong> (academic semesters). 
                                Start early and monitor <a href="https://offlist.ch" class="text-[#FF6F61] font-medium hover:underline">Offlist.ch</a> for pre-market listings.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Step 2 -->
                <div class="bg-white rounded-2xl p-8 border border-slate-200 shadow-sm hover:shadow-md transition-shadow">
                    <div class="flex items-start gap-6">
                        <div class="shrink-0 w-14 h-14 bg-slate-200 rounded-xl flex items-center justify-center text-slate-500 font-bold text-lg">
                            02
                        </div>
                        <div class="flex-1">
                            <div class="flex items-center gap-3 mb-3">
                                <span class="px-3 py-1 bg-slate-100 text-slate-500 text-xs font-bold rounded-full uppercase tracking-wider border border-slate-200">2 Months Out</span>
                            </div>
                            <h3 class="text-xl font-bold text-slate-800 mb-2">The Application</h3>
                            <p class="text-slate-600 leading-relaxed">
                                Prepare a standard <strong>R√©gie dossier</strong>: work contract, passport, references, and proof of income. 
                                Use Offlist.ch to bypass the R√©gie queue and connect directly with private landlords.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Step 3 -->
                <div class="bg-white rounded-2xl p-8 border border-slate-200 shadow-sm hover:shadow-md transition-shadow">
                    <div class="flex items-start gap-6">
                        <div class="shrink-0 w-14 h-14 bg-slate-200 rounded-xl flex items-center justify-center text-slate-500 font-bold text-lg">
                            03
                        </div>
                        <div class="flex-1">
                            <div class="flex items-center gap-3 mb-3">
                                <span class="px-3 py-1 bg-slate-100 text-slate-500 text-xs font-bold rounded-full uppercase tracking-wider border border-slate-200">Arrival Week</span>
                            </div>
                            <h3 class="text-xl font-bold text-slate-800 mb-2">Registration at Contr√¥le des habitants</h3>
                            <p class="text-slate-600 leading-relaxed">
                                Register at the <strong>Contr√¥le des habitants</strong> within <strong>8 days</strong> of arrival. 
                                Bring your lease, work contract, and passport. The registration office is at Place Chauderon.
                            </p>
                        </div>
                    </div>
                </div>

                <!-- Step 4: Health Insurance -->
                <div class="bg-white rounded-2xl p-8 border border-slate-200 shadow-sm hover:shadow-md transition-shadow">
                    <div class="flex items-start gap-6">
                        <div class="shrink-0 w-14 h-14 bg-slate-200 rounded-xl flex items-center justify-center text-slate-500 font-bold text-lg">
                            04
                        </div>
                        <div class="flex-1">
                            <div class="flex items-center gap-3 mb-3">
                                <span class="px-3 py-1 bg-slate-100 text-slate-500 text-xs font-bold rounded-full uppercase tracking-wider border border-slate-200">Within 3 Months</span>
                            </div>
                            <h3 class="text-xl font-bold text-slate-800 mb-2">Health Insurance</h3>
                            <p class="text-slate-600 leading-relaxed mb-4">
                                Vaud requires strict compliance. You must provide proof of insurance to the 'Contr√¥le des habitants'.
                            </p>
                            <div class="bg-slate-50 rounded-lg p-4 border border-slate-200">
                                <p class="text-slate-700 text-sm leading-relaxed">
                                    <span class="font-bold">üí° Expert Tip:</span> Health insurance premiums vary by zip code. Use the 
                                    <a href="https://expat-savvy.ch/healthcare/best-health-insurance-switzerland/" target="_blank" rel="noopener" class="text-[#FF6F61] underline hover:text-[#f65d4e]">best health insurance guide</a> 
                                    at Expat-Savvy to compare providers and find the right plan.
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>


    <section class="py-24 bg-white border-t border-slate-100">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-3xl md:text-4xl font-bold text-slate-800 mb-4">Deep Dives & Market Insights</h2>
                <p class="text-slate-500 text-lg">Expert analysis for your Lausanne relocation.</p>
            </div>

            <div class="grid md:grid-cols-3 gap-8">
                <!-- Card 1 -->
                <a href="/blog/best-relocation-agencies-switzerland-comparison" class="group bg-white rounded-2xl border border-slate-200 overflow-hidden hover:shadow-xl hover:-translate-y-1 transition-all duration-300 block">
                    <div class="aspect-[16/9] overflow-hidden bg-slate-100">
                        <img 
                            src="https://images.unsplash.com/photo-1600880292203-757bb62b4baf?w=600&h=340&fit=crop&fm=webp" 
                            alt="Agency meeting" 
                            class="w-full h-full object-cover grayscale group-hover:grayscale-0 group-hover:scale-105 transition-all duration-500"
                        />
                    </div>
                    <div class="p-6">
                        <div class="mb-3">
                            <span class="inline-block px-3 py-1 bg-[#FF6F61]/10 text-[#FF6F61] text-xs font-bold rounded-full uppercase tracking-wider">Agencies</span>
                        </div>
                        <h3 class="text-lg font-bold text-slate-800 mb-2 group-hover:text-[#FF6F61] transition-colors">Best Relocation Agencies Switzerland: A Transparency Guide</h3>
                        <p class="text-slate-600 text-sm leading-relaxed">Everything you need to know about professional support in Lausanne and Canton Vaud.</p>
                    </div>
                </a>

                <!-- Card 2 -->
                <a href="/blog/cost-of-living-switzerland-breakdown-2026" class="group bg-white rounded-2xl border border-slate-200 overflow-hidden hover:shadow-xl hover:-translate-y-1 transition-all duration-300 block">
                    <div class="aspect-[16/9] overflow-hidden bg-slate-100">
                        <img 
                            src="https://images.unsplash.com/photo-1554224155-6726b3ff858f?w=600&h=340&fit=crop&fm=webp" 
                            alt="Swiss finance" 
                            class="w-full h-full object-cover grayscale group-hover:grayscale-0 group-hover:scale-105 transition-all duration-500"
                        />
                    </div>
                    <div class="p-6">
                        <div class="mb-3">
                            <span class="inline-block px-3 py-1 bg-[#FF6F61]/10 text-[#FF6F61] text-xs font-bold rounded-full uppercase tracking-wider">Finance</span>
                        </div>
                        <h3 class="text-lg font-bold text-slate-800 mb-2 group-hover:text-[#FF6F61] transition-colors">The Real Cost of Living in Switzerland: 2026 Guide</h3>
                        <p class="text-slate-600 text-sm leading-relaxed">A detailed breakdown of monthly expenses for a family or professional in Lausanne.</p>
                    </div>
                </a>

                <!-- Card 3 -->
                <a href="/blog/home-search-switzerland-agency-vs-platform" class="group bg-white rounded-2xl border border-slate-200 overflow-hidden hover:shadow-xl hover:-translate-y-1 transition-all duration-300 block">
                    <div class="aspect-[16/9] overflow-hidden bg-slate-100">
                        <img 
                            src="https://images.unsplash.com/photo-1560518883-ce09059eeffa?w=600&h=340&fit=crop&fm=webp" 
                            alt="Luxury Swiss apartment" 
                            class="w-full h-full object-cover grayscale group-hover:grayscale-0 group-hover:scale-105 transition-all duration-500"
                        />
                    </div>
                    <div class="p-6">
                        <div class="mb-3">
                            <span class="inline-block px-3 py-1 bg-[#FF6F61]/10 text-[#FF6F61] text-xs font-bold rounded-full uppercase tracking-wider">Housing</span>
                        </div>
                        <h3 class="text-lg font-bold text-slate-800 mb-2 group-hover:text-[#FF6F61] transition-colors">Relocation Agencies vs. Selection Platforms (2026)</h3>
                        <p class="text-slate-600 text-sm leading-relaxed">How to decide between high-touch human service and digital efficiency in Lausanne.</p>
                    </div>
                </a>
            </div>
        </div>
    </section>


    <!-- 8. FAQ Section -->
    <section class="py-24 bg-white border-t border-slate-100">
        <div class="max-w-3xl mx-auto px-4 sm:px-6 lg:px-8">
            <h2 class="text-2xl md:text-3xl font-bold text-slate-800 mb-10 text-center">Frequently Asked Questions</h2>
            <div class="space-y-4">
                {faqs.map((faq) => (
                    <details class="group bg-[#F9FAFB] border border-slate-200 rounded-lg overflow-hidden">
                        <summary class="flex justify-between items-center p-5 cursor-pointer font-semibold text-slate-800 hover:bg-slate-100 transition-colors select-none text-lg">
                            {faq.q}
                            <ChevronDown className="w-5 h-5 text-slate-400 group-open:rotate-180 transition-transform" />
                        </summary>
                        <div class="px-5 pb-6 pt-2 text-slate-600 leading-relaxed border-t border-slate-100">
                            {faq.a}
                        </div>
                    </details>
                ))}
            </div>
        </div>
    </section>

    <!-- 8. Footer -->
    <Footer theme="dark" />

    <!-- Modal Globals -->
    <div id="relofinder-modal-marker" data-relofinder-modal="pending" style="display: none;" aria-hidden="true"></div>
    <UniversalContactModal client:load />
    
    <!-- Scripts (Exact same as index.astro for modal handling) -->
    <script is:inline>
      if (typeof window !== 'undefined') {
        window.modalEventQueue = window.modalEventQueue || [];
        window.modalReady = false;
        
        // Define functions immediately
        window.universalOpenModal = function(context) {
          const resolvedContext = context && typeof context === 'object' ? context : { page: 'lausanne_guide', topic: context };
          console.log('üìû universalOpenModal called', resolvedContext);
          if (window.modalReady && window.relofinderModalStores) {
            window.relofinderModalStores.setContext(resolvedContext);
            window.relofinderModalStores.setOpen(true);
            return;
          }
          window.modalEventQueue.push({ kind: 'open', payload: resolvedContext });
        };

        window.closeModal = function() {
           if (window.modalReady && window.relofinderModalStores) {
            window.relofinderModalStores.setOpen(false);
          } else {
            window.modalEventQueue.push({ kind: 'close' });
          }
        };
      }
      
      // Browser-only setup
      if (typeof window !== 'undefined') {
        // Listen for React/Nanostores availability
        const checkInterval = setInterval(() => {
            if (window.relofinderModalStores) {
                window.modalReady = true;
                // Process queue
                window.modalEventQueue.forEach(item => {
                    if (item.kind === 'open') window.relofinderModalStores.setContext(item.payload), window.relofinderModalStores.setOpen(true);
                    if (item.kind === 'close') window.relofinderModalStores.setOpen(false);
                });
                window.modalEventQueue = [];
                clearInterval(checkInterval);
            }
        }, 100);
      }
    </script>
</body>
</html>
